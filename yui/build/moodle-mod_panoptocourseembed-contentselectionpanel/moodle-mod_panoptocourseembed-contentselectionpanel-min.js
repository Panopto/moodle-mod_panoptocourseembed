YUI.add("moodle-mod_panoptocourseembed-contentselectionpanel",function(n,e){var t=function(){t.superclass.constructor.apply(this,arguments)};n.extend(t,n.Base,{courseid:null,isResponsive:!1,init:function(e){var t,i,o;"0"!==e.folderviewbtnid&&"0"!==e.selectvidbtnid&&"0"!==e.lticimlaunchurl&&"0"!==e.ltilaunchurl&&0!==e.courseid&&0!==e.height&&0!==e.width&&0!==e.isresponsive&&(this.courseid=e.courseid,this.isResponsive=e.isresponsive,t=n.one("#"+e.selectvidbtnid),i=n.one("#"+e.folderviewbtnid),t.on("click",this.open_panopto_window_callback,this,e.lticimlaunchurl,e.height,e.width),i.on("click",this.panopto_folder_view_callback,this,e.ltilaunchurl,600,400),this._createResourceLinkId=(o=e.resourcebase,function(){return o+"_"+(new Date).getTime()}))},open_panopto_window_callback:function(e,t,i,o){t=new M.core.dialogue({bodyContent:'<iframe src="'+t+'" width="100%" height="100%"></iframe>',headerContent:M.util.get_string("selectvideo","panoptocourseembed"),width:o,height:i,draggable:!1,visible:!0,zindex:100,modal:!0,focusOnPreviousTargetAfterHide:!0,render:!0});document.body.panoptoWindow=t,document.body.addEventListener("sessionSelected",this.close_popup_callback.bind(this),!1)},panopto_folder_view_callback:function(e,t,i,o){t=new URL(t),t=this.isResponsive?'<p><iframe src="'+t.toString()+'" style="width:100%; height:auto; aspect-ratio: '+o+" / "+i+';" allowfullscreen="true"></iframe><br /></p>':'<p><iframe src="'+t.toString()+'" width="'+o+'" height="'+i+'" allowfullscreen="true"></iframe><br /></p>';n.one("input[name=intro]").setAttribute("value",t),n.one("#panopto-intro-preview").setContent(t),n.one("#id_select_video").set("value",M.util.get_string("selectvideo","panoptocourseembed")),n.one("#id_select_video").removeClass("btn-secondary"),n.one("#id_select_video").addClass("btn-primary")},close_popup_callback:function(e){var t=new URL(e.detail.ltiViewerUrl),i=t.searchParams;i.set("course",this.courseid),i.set("custom",decodeURI(e.detail.customData)),i.set("contentUrl",e.detail.contentUrl),i.set("resourcelinkid",this._createResourceLinkId()),t.search=i.toString(),i=this.isResponsive?'<p><iframe src="'+t.toString()+'" style="width:100%; height:auto; aspect-ratio: '+e.detail.width+" / "+e.detail.height+';" allowfullscreen="true"></iframe><br /></p>':'<p><iframe src="'+t.toString()+'" width="'+e.detail.width+'" height="'+e.detail.height+'" allowfullscreen="true"></iframe><br></p>',n.one("input[name=intro]").setAttribute("value",i),n.one("#panopto-intro-preview").setContent(i),n.one("#id_select_video").set("value",M.util.get_string("replacevideo","panoptocourseembed")),n.one("#id_select_video").addClass("btn-secondary"),n.one("#id_select_video").removeClass("btn-primary"),document.body.panoptoWindow.destroy()}},{NAME:"moodle-mod_panoptocourseembed-contentselectionpanel",ATTRS:{selectvidbtnid:{value:"0"},folderviewbtnid:{value:"0"},lticimlaunchurl:{value:"0"},ltilaunchurl:{value:"0"},height:{value:0},width:{value:0},courseid:{value:0},resourcebase:{value:"0"}}}),M.mod_panoptocourseembed=M.mod_panoptocourseembed||{},M.mod_panoptocourseembed.initcontentselectionpanel=function(e){return new t(e)}},"@VERSION@",{requires:["base","node","panel","moodle-core-notification","node-event-simulate"]});